@model SearchViewModel
@{
    ViewData["Title"] = "Tìm kiếm điện thoại";
}

<div class="container mt-4">
    <div class="row">
        <aside class="col-md-3">
            <form method="get" asp-action="Index" class="card p-3 shadow-sm border-0">
                <h5 class="fw-bold mb-3">Bộ lọc tìm kiếm</h5>
                <div class="mb-3">
                    <label class="form-label text-secondary fw-semibold">Từ khóa (Tên, Mô tả)</label>
                    <input type="text" name="keyword" class="form-control"
                           value="@Model.Keyword" placeholder="Nhập tên máy cần tìm...">
                </div>
                <div class="mb-3">
                    <label class="form-label">Hãng sản xuất</label>
                    <select name="brandId" class="form-select" asp-for="BrandId">
                        <option value="">Tất cả hãng</option>
                        @foreach (var brand in Model.Brands)
                        {
                            <option value="@brand.MaHangDienThoai">@brand.TenHangDienThoai</option>
                        }
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Giá từ (VNĐ)</label>
                    <input type="number" name="minPrice" class="form-control" value="@Model.MinPrice" placeholder="0">
                </div>
                <div class="mb-3">
                    <label class="form-label">Đến giá (VNĐ)</label>
                    <input type="number" name="maxPrice" class="form-control" value="@Model.MaxPrice" placeholder="50,000,000">
                </div>

                <button type="submit" class="btn btn-warning w-100 fw-bold">Tìm kiếm ngay</button>
            </form>
        </aside>

        <main class="col-md-9">
            @if (Model.Products != null && Model.Products.Any())
            {
                <div class="row row-cols-1 row-cols-md-3 g-4">
                    @foreach (var item in Model.Products)
                    {
                        <div class="col">
                            <div class="card h-100 shadow-sm border-0">
                                <img src="@item.Thumbnail" class="card-img-top p-3" alt="@item.TenDienThoai">
                                <div class="card-body text-center">
                                    <h6 class="card-title fw-bold">@item.TenDienThoai</h6>
                                    <p class="text-danger fw-bold fs-5">@item.DonGia.ToString("N0")₫</p>
                                    <a asp-controller="ChiTietSanPham"
                                       asp-action="Index"
                                       asp-route-id="@item.MaDienThoai"
                                       class="btn btn-outline-warning">
                                        Xem chi tiết
                                    </a>
                                </div>
                            </div>
                        </div>
                    }
                </div>

                @if (Model.TotalPages > 1)
                {
                    <nav class="mt-5">
                        <ul class="pagination justify-content-center">
                            @for (int i = 1; i <= Model.TotalPages; i++)
                            {
                                <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                                    <a class="page-link shadow-none" href="@Url.Action("Index", new { keyword = Model.Keyword, brandId = Model.BrandId, minPrice = Model.MinPrice, maxPrice = Model.MaxPrice, page = i })">@i</a>
                                </li>
                            }
                        </ul>
                    </nav>
                }
            }
            else
            {
                <div class="text-center py-5 shadow-sm bg-light rounded-3">
                    <i class="fas fa-box-open fa-4x text-secondary mb-3"></i>
                    <h4 class="text-dark fw-bold">Rất tiếc, không tìm thấy sản phẩm!</h4>
                    <p class="text-muted">Không có sản phẩm nào khớp với từ khóa "<strong>@Model.Keyword</strong>" hoặc bộ lọc bạn đã chọn.</p>
                    <a href="@Url.Action("Index", "DienThoai")" class="btn btn-warning fw-bold mt-2">Xem tất cả sản phẩm</a>
                </div>
            }
        </main>
    </div>
</div>